<html xmlns:v="urn:schemas-microsoft-com:vml"
  xmlns:o="urn:schemas-microsoft-com:office:office"
  xmlns:w="urn:schemas-microsoft-com:office:word"
  xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
  xmlns="http://www.w3.org/TR/REC-html40">
  <head>
    <meta http-equiv=Content-Type content="text/html; charset=windows-1252">
    <meta name=ProgId content=Word.Document>
    <meta name=Generator content="Microsoft Word 15">
    <meta name=Originator content="Microsoft Word 15">
    <link rel=File-List href="mch_files/filelist.xml">
    <link rel=themeData href="mch_files/themedata.thmx">
    <link rel=colorSchemeMapping href="mch_files/colorschememapping.xml">
    <style>
      <!--
        /* Font Definitions */
        @font-face
        {font-family:Wingdings;
        panose-1:5 0 0 0 0 0 0 0 0 0;
        mso-font-charset:2;
        mso-generic-font-family:auto;
        mso-font-pitch:variable;
        mso-font-signature:0 268435456 0 0 -2147483648 0;}
        @font-face
        {font-family:"Cambria Math";
        panose-1:2 4 5 3 5 4 6 3 2 4;
        mso-font-charset:0;
        mso-generic-font-family:roman;
        mso-font-pitch:variable;
        mso-font-signature:-536870145 1107305727 0 0 415 0;}
        @font-face
        {font-family:"Calibri Light";
        panose-1:2 15 3 2 2 2 4 3 2 4;
        mso-font-charset:0;
        mso-generic-font-family:swiss;
        mso-font-pitch:variable;
        mso-font-signature:-536859905 -1073732485 9 0 511 0;}
        @font-face
        {font-family:"Yu Mincho";
        panose-1:2 2 4 0 0 0 0 0 0 0;
        mso-font-alt:\6E38\660E\671D;
        mso-font-charset:128;
        mso-generic-font-family:roman;
        mso-font-pitch:variable;
        mso-font-signature:-2147482905 717749503 18 0 131231 0;}
        @font-face
        {font-family:Verdana;
        panose-1:2 11 6 4 3 5 4 4 2 4;
        mso-font-charset:0;
        mso-generic-font-family:swiss;
        mso-font-pitch:variable;
        mso-font-signature:-1593833729 1073750107 16 0 415 0;}
        @font-face
        {font-family:Consolas;
        panose-1:2 11 6 9 2 2 4 3 2 4;
        mso-font-charset:0;
        mso-generic-font-family:modern;
        mso-font-pitch:fixed;
        mso-font-signature:-536869121 64767 1 0 415 0;}
        @font-face
        {font-family:"\@Yu Mincho";
        mso-font-charset:128;
        mso-generic-font-family:roman;
        mso-font-pitch:variable;
        mso-font-signature:-2147482905 717749503 18 0 131231 0;}
        /* Style Definitions */
        p.MsoNormal, li.MsoNormal, div.MsoNormal
        {mso-style-unhide:no;
        mso-style-qformat:yes;
        mso-style-parent:"";
        margin:0cm;
        margin-bottom:.0001pt;
        mso-pagination:widow-orphan;
        font-size:10.0pt;
        font-family:"Verdana",sans-serif;
        mso-fareast-font-family:"Yu Mincho";
        mso-fareast-theme-font:minor-fareast;
        mso-bidi-font-family:"Times New Roman";}
        h1
        {mso-style-priority:9;
        mso-style-unhide:no;
        mso-style-qformat:yes;
        mso-style-link:"Heading 1 Char";
        margin-top:12.0pt;
        margin-right:0cm;
        margin-bottom:0cm;
        margin-left:0cm;
        margin-bottom:.0001pt;
        mso-pagination:widow-orphan;
        page-break-after:avoid;
        mso-outline-level:1;
        font-size:16.0pt;
        font-family:"Calibri Light",sans-serif;
        color:#2E74B5;
        font-weight:normal;}
        h2
        {mso-style-noshow:yes;
        mso-style-priority:9;
        mso-style-qformat:yes;
        mso-style-link:"Heading 2 Char";
        margin-top:2.0pt;
        margin-right:0cm;
        margin-bottom:0cm;
        margin-left:0cm;
        margin-bottom:.0001pt;
        mso-pagination:widow-orphan;
        page-break-after:avoid;
        mso-outline-level:2;
        font-size:13.0pt;
        font-family:"Calibri Light",sans-serif;
        color:#2E74B5;
        font-weight:normal;}
        h3
        {mso-style-noshow:yes;
        mso-style-priority:9;
        mso-style-qformat:yes;
        mso-style-link:"Heading 3 Char";
        margin-top:2.0pt;
        margin-right:0cm;
        margin-bottom:0cm;
        margin-left:0cm;
        margin-bottom:.0001pt;
        mso-pagination:widow-orphan;
        page-break-after:avoid;
        mso-outline-level:3;
        font-size:12.0pt;
        font-family:"Calibri Light",sans-serif;
        color:#1F4D78;
        font-weight:normal;}
        a:link, span.MsoHyperlink
        {mso-style-noshow:yes;
        mso-style-priority:99;
        color:#0563C1;
        text-decoration:underline;
        text-underline:single;}
        a:visited, span.MsoHyperlinkFollowed
        {mso-style-noshow:yes;
        mso-style-priority:99;
        color:#954F72;
        mso-themecolor:followedhyperlink;
        text-decoration:underline;
        text-underline:single;}
        p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
        {mso-style-priority:34;
        mso-style-unhide:no;
        mso-style-qformat:yes;
        margin-top:0cm;
        margin-right:0cm;
        margin-bottom:0cm;
        margin-left:36.0pt;
        margin-bottom:.0001pt;
        mso-pagination:widow-orphan;
        font-size:10.0pt;
        font-family:"Verdana",sans-serif;
        mso-fareast-font-family:"Yu Mincho";
        mso-fareast-theme-font:minor-fareast;
        mso-bidi-font-family:"Times New Roman";
        mso-fareast-language:EN-US;}
        span.Heading1Char
        {mso-style-name:"Heading 1 Char";
        mso-style-priority:9;
        mso-style-unhide:no;
        mso-style-locked:yes;
        mso-style-link:"Heading 1";
        mso-ansi-font-size:16.0pt;
        mso-bidi-font-size:16.0pt;
        font-family:"Calibri Light",sans-serif;
        mso-ascii-font-family:"Calibri Light";
        mso-hansi-font-family:"Calibri Light";
        mso-bidi-font-family:"Calibri Light";
        color:#2E74B5;
        mso-font-kerning:18.0pt;}
        span.Heading2Char
        {mso-style-name:"Heading 2 Char";
        mso-style-noshow:yes;
        mso-style-priority:9;
        mso-style-unhide:no;
        mso-style-locked:yes;
        mso-style-link:"Heading 2";
        mso-ansi-font-size:13.0pt;
        mso-bidi-font-size:13.0pt;
        font-family:"Calibri Light",sans-serif;
        mso-ascii-font-family:"Calibri Light";
        mso-hansi-font-family:"Calibri Light";
        mso-bidi-font-family:"Calibri Light";
        color:#2E74B5;}
        span.Heading3Char
        {mso-style-name:"Heading 3 Char";
        mso-style-noshow:yes;
        mso-style-priority:9;
        mso-style-unhide:no;
        mso-style-locked:yes;
        mso-style-link:"Heading 3";
        mso-ansi-font-size:12.0pt;
        mso-bidi-font-size:12.0pt;
        font-family:"Calibri Light",sans-serif;
        mso-ascii-font-family:"Calibri Light";
        mso-hansi-font-family:"Calibri Light";
        mso-bidi-font-family:"Calibri Light";
        color:#1F4D78;}
        .MsoChpDefault
        {mso-style-type:export-only;
        mso-default-props:yes;
        font-family:"Calibri",sans-serif;
        mso-ascii-font-family:Calibri;
        mso-ascii-theme-font:minor-latin;
        mso-fareast-font-family:"Yu Mincho";
        mso-fareast-theme-font:minor-fareast;
        mso-hansi-font-family:Calibri;
        mso-hansi-theme-font:minor-latin;
        mso-bidi-font-family:"Times New Roman";
        mso-bidi-theme-font:minor-bidi;}
        .MsoPapDefault
        {mso-style-type:export-only;
        margin-bottom:8.0pt;
        line-height:107%;}
        @page WordSection1
        {size:595.3pt 841.9pt;
        margin:72.0pt 72.0pt 72.0pt 72.0pt;
        mso-header-margin:35.4pt;
        mso-footer-margin:35.4pt;
        mso-paper-source:0;}
        div.WordSection1
        {page:WordSection1;}
        -->
    </style>
  </head>
  <body lang=EN-GB link="#0563C1" vlink="#954F72" style='tab-interval:36.0pt'>
    <div class=WordSection1>
      <p class=MsoNormal>
        In order to use the tags, you need to add the following to
        &lt;gel:script&gt;
        <o:p></o:p>
      </p>
      <p class=MsoNormal>
        <o:p>&nbsp;</o:p>
      </p>
      <p class=MsoNormal>
        <span style='font-family:Consolas'>&lt;gel:script
        xmlns:xsd=&quot;</span><span lang=IT style='font-family:Consolas;mso-ansi-language:
          IT'><a href="http://www.w3.org/2001/XMLSchema"><span lang=EN-GB
          style='mso-ansi-language:EN-GB'>http://www.w3.org/2001/XMLSchema</span></a></span>
        <span
          style='font-family:Consolas'>
          &quot;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal>
        <span style='font-family:Consolas'><span
          style='mso-spacerun:yes'>           </span><span
          style='mso-spacerun:yes'> </span>xmlns:xsi=&quot;</span><span lang=IT
          style='font-family:Consolas;mso-ansi-language:IT'><a
          href="http://www.w3.org/2001/XMLSchema-instance"><span lang=EN-GB
          style='mso-ansi-language:EN-GB'>http://www.w3.org/2001/XMLSchema-instance</span></a></span>
        <span
          style='font-family:Consolas'>
          &quot;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal>
        <span style='font-family:Consolas'>
          &nbsp;&nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <b>
            xmlns:MCh=&quot;jelly:eu.mesmerizedChild.commons.jelly.MChTagLibrary&quot;
            <o:p></o:p>
          </b>
        </span>
      </p>
      <p class=MsoNormal>
        <span style='font-family:Consolas'>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          ... &gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal>
        <span style='font-size:8.0pt'>
          <o:p>&nbsp;</o:p>
        </span>
      </p>
      <h1>
        <span style='mso-fareast-font-family:"Times New Roman"'>
          The tags:
          <o:p></o:p>
        </span>
      </h1>
      <h2>
        <span style='font-family:Consolas;mso-fareast-font-family:"Times New Roman"'>
          query
          <o:p></o:p>
        </span>
      </h2>
      <p class=MsoListParagraph>
        This tag extends the standard <span style='font-family:
          Consolas;mso-bidi-font-style:italic'>&lt;sql:query/&gt;</span> tag, so you can
        do with it anything that you can do with <span style='font-family:Consolas;
          mso-bidi-font-style:italic'>&lt;sql:query/&gt;</span> itself [for example, use
        the <span style='font-family:Consolas;mso-bidi-font-style:italic'>&lt;sql:param/&gt;</span>
        tag inside the query].
        <o:p></o:p>
      </p>
      <p class=MsoListParagraph>
        <o:p>&nbsp;</o:p>
      </p>
      <p class=MsoListParagraph>
        However, this tag is mainly targeted for those cases
        where the query returns exactly one row, by means of the <span
          style='font-family:Consolas'>into</span> attribute. Example:
        <o:p></o:p>
      </p>
      <p class=MsoNormal>
        <o:p>&nbsp;</o:p>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;MCh:query
          <b>into=&quot;*&quot;</b> &gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          SELECT column_1,
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_2,
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;something as column_3
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          FROM&nbsp;&nbsp; table
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;/MCh:query&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal>
        <o:p>&nbsp;</o:p>
      </p>
      <p class=MsoNormal style='margin-left:35.4pt'>
        This is equivalent to:
        <o:p></o:p>
      </p>
      <p class=MsoNormal style='margin-left:35.4pt'>
        <o:p>&nbsp;</o:p>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;sql:query
          var=&quot;theQuery&quot; &gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          SELECT column_1,
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_2,
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;something as column_3
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          FROM&nbsp;&nbsp; table
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;/sql:query&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;core:if
          test=&quot;${theQuery.rowCount == 0}&quot; &gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          &lt;core:throw&gt;No data was retrieved from the database. &lt;/core:throw&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;/core:if&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;core:set
          value=&quot;${theQuery.rows[0]}&quot; var=&quot;theRow&quot; /&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;core:set
          value=&quot;${theRow.column_1}&quot; var=&quot;column_1&quot; /&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;core:set
          value=&quot;${theRow.column_2}&quot; var=&quot;column_2&quot; /&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;core:set
          value=&quot;${theRow.column_3}&quot; var=&quot;column_3&quot; /&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal>
        <span style='font-family:Consolas'>
          <o:p>&nbsp;</o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:35.4pt'>
        So, after <span style='font-family:
          Consolas;mso-bidi-font-style:italic'>&lt;MCh:query/&gt;</span> you can
        immediately use the GEL variables with the same name as the SQL columns.
        <o:p></o:p>
      </p>
      <p class=MsoNormal style='margin-left:35.4pt'>
        It should be useful for those 70-
        or 80-field queries that we see lurking around <span style='font-family:Wingdings;
          mso-ascii-font-family:Verdana;mso-hansi-font-family:Verdana;mso-char-type:symbol;
          mso-symbol-font-family:Wingdings'><span style='mso-char-type:symbol;mso-symbol-font-family:
          Wingdings'>J</span></span> ...
        <o:p></o:p>
      </p>
      <p class=MsoNormal style='margin-left:35.4pt'>
        <o:p>&nbsp;</o:p>
      </p>
      <p class=MsoNormal style='margin-left:35.4pt'>
        Beware: by default this tag
        raises an exception if the query does not return any rows.
        <o:p></o:p>
      </p>
      <p class=MsoNormal style='margin-left:35.4pt'>
        You can use the <span
          style='font-family:Consolas;mso-bidi-font-style:italic'>nullIfEmpty</span>
        attribute with a value of “true” if it’s Ok that the query returns 0 records,
        in which case the variables will be set to null. Example:
        <o:p></o:p>
      </p>
      <p class=MsoNormal style='margin-left:35.4pt'>
        <o:p>&nbsp;</o:p>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;MCh:query
          into=&quot;*&quot; nullIfEmpty=&quot;true&quot;&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          SELECT column_1,
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_2,
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_3
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          FROM&nbsp;&nbsp; table
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;/MCh:query&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;!--
          No exception will be raised.
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;&nbsp;&nbsp;&nbsp;
          Variables column_1, column_2 and column_3 will be null if the query does not
          return any rows,
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<b>even</b>* if they had some values before
          MCh:query --&gt; 
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal>
        <o:p>&nbsp;</o:p>
      </p>
      <p class=MsoNormal style='margin-left:35.4pt'>
        Finally, if the query returns
        more than one row, then the rows after the first one are silently discarded.
        <o:p></o:p>
      </p>
      <p class=MsoNormal>
        <o:p>&nbsp;</o:p>
      </p>
      <h2>
        <span style='font-family:Consolas;mso-fareast-font-family:"Times New Roman"'>
          forEachRow
          <o:p></o:p>
        </span>
      </h2>
      <p class=MsoNormal style='margin-left:35.4pt'>
        This tag is meant as a
        replacement of <span style='font-family:Consolas'>&lt;<span style='mso-bidi-font-style:
          italic'>core:forEach/&gt;</span></span> when using a result set [such as the
        result from <span style='font-family:Consolas;mso-bidi-font-style:italic'>&lt;sql:query/&gt;</span>]
        <o:p></o:p>
      </p>
      <p class=MsoNormal align=center style='margin-left:35.4pt;text-align:center'>
        <o:p>&nbsp;</o:p>
      </p>
      <p class=MsoNormal style='margin-left:35.4pt'>
        You need to specify two
        attributes:
        <o:p></o:p>
      </p>
      <h3 style='margin-left:70.8pt'>
        <span style='font-family:Consolas;mso-fareast-font-family:
          "Times New Roman"'>
          result
          <o:p></o:p>
        </span>
      </h3>
      <p class=MsoNormal style='margin-left:70.8pt'>
        An expression that specifies from
        where the result set should be taken
        <o:p></o:p>
      </p>
      <h3 style='margin-left:70.8pt'>
        <span style='font-family:Consolas;mso-fareast-font-family:
          "Times New Roman"'>
          into
          <o:p></o:p>
        </span>
      </h3>
      <p class=MsoNormal style='margin-left:70.8pt'>
        same meaning as for the <i>query</i>
        tag
        <o:p></o:p>
      </p>
      <p class=MsoNormal style='margin-left:35.4pt'>
        <o:p>&nbsp;</o:p>
      </p>
      <p class=MsoNormal style='margin-left:35.4pt'>
        The aim is to be able to use
        variables with the same names as the query columns, inside the loop.
        <o:p></o:p>
      </p>
      <p class=MsoNormal style='margin-left:35.4pt'>
        So, for example:
        <o:p></o:p>
      </p>
      <p class=MsoNormal style='margin-left:35.4pt'>
        <o:p>&nbsp;</o:p>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;sql:query
          var=&quot;theQuery&quot; &gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>&nbsp;
        </span>
        <span lang=IT style='font-family:Consolas;mso-ansi-language:IT'>
          SELECT
          column_1,
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_2,
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;something as column_3
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          FROM&nbsp;&nbsp; table
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;/sql:query&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;MCh:forEachRow
          result=&quot;${theQuery}&quot; into=&quot;*&quot;&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>&nbsp;
        </span>
        <span lang=ES style='font-family:Consolas;mso-ansi-language:ES'>
          &lt;gel:log&gt;${column_1},${column_2},${column_3}&lt;/gel:log&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;/MCh:forEachRow&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal>
        <o:p>&nbsp;</o:p>
      </p>
      <p class=MsoNormal style='margin-left:35.4pt'>
        Also, the standard <span
          style='font-family:Consolas'>&lt;<span style='mso-bidi-font-style:italic'>core:break/&gt;</span></span>
        tag may be used to exit the loop, just like with the standard <span
          style='font-family:Consolas'>&lt;core:forEach/&gt;</span> tag:
        <o:p></o:p>
      </p>
      <p class=MsoNormal>
        <o:p>&nbsp;</o:p>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;MCh:forEachRow
          result=&quot;${theQuery}&quot; into=&quot;*&quot;&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          &lt;core:if test=&quot;${some_condition}&quot; &gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;&nbsp;&nbsp;
          &lt;core:break /&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          &lt;/core:if&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;/MCh:forEachRow&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal>
        <o:p>&nbsp;</o:p>
      </p>
      <h1>
        <span style='mso-fareast-font-family:"Times New Roman"'>The </span><span
          style='font-family:Consolas;mso-fareast-font-family:"Times New Roman";
          mso-bidi-font-style:italic'>into</span>
        <span style='mso-fareast-font-family:
          "Times New Roman"'>
          attribute...
          <o:p></o:p>
        </span>
      </h1>
      <p class=MsoNormal>
        The <span style='font-family:Consolas;mso-bidi-font-style:
          italic'>into</span> attribute, both in the <span style='font-family:Consolas;
          mso-bidi-font-style:italic'>query</span> and in the <span style='font-family:
          Consolas;mso-bidi-font-style:italic'>forEachRow</span> tags, tells the tag how
        to map between the column names and the variable names.
        <o:p></o:p>
      </p>
      <p class=MsoNormal>
        <o:p>&nbsp;</o:p>
      </p>
      <p class=MsoNormal>
        The <span style='font-family:Consolas'>&quot;*&quot;</span>
        setting simply tells the tags to take the column names from the query, and
        create variables with the same name and the same content.
        <o:p></o:p>
      </p>
      <p class=MsoNormal>
        <o:p>&nbsp;</o:p>
      </p>
      <p class=MsoNormal>
        However, the <span style='font-family:Consolas;mso-bidi-font-style:
          italic'>into</span> attribute can be more subtle than that; imagine you have an
        existing 40-column query, but for a particular loop you are only interested in
        a handful of columns from that query. In this case, using <span
          style='font-family:Consolas'>&quot;*&quot;</span> would be a waste of time,
        memory, performance, etc.
        <o:p></o:p>
      </p>
      <p class=MsoNormal>
        <o:p>&nbsp;</o:p>
      </p>
      <p class=MsoNormal>So, the attribute can be used in two more ways:</p>
      <p class=MsoNormal>
        <o:p>&nbsp;</o:p>
      </p>
      <h2>
        <span style='mso-fareast-font-family:"Times New Roman"'>
          Positional:
          <o:p></o:p>
        </span>
      </h2>
      <p class=MsoNormal style='margin-left:35.4pt'>
        In this case the <span
          style='font-family:Consolas;mso-bidi-font-style:italic'>into</span> attribute
        lists the variables names to which each column is associated, and the position
        of each variable name inside the list counts; the first variable in the list
        will be set to the value of the first column in the query, the second variable
        will be set to the value of the second column and so on. The following example
        uses the <span style='font-family:Consolas'>query</span> tag, but the same
        applies to the <span style='font-family:Consolas'>forEachRow</span> tag:
        <o:p></o:p>
      </p>
      <p class=MsoNormal>
        <o:p>&nbsp;</o:p>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;MCh:query
          into=&quot;<b>var_first</b>,var_second,var_third&quot; &gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          SELECT <b>column_1</b>,
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_2,
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;something as column_3
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          FROM&nbsp;&nbsp; table
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;/MCh:query&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;!--
          var_first now contains the value of column1, etc. --&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;gel:log&gt;column1:
          ${var_first}, column2: ${var_second}, column3: ${var_third}&lt;/gel:log&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal>
        <o:p>&nbsp;</o:p>
      </p>
      <h2>
        <span style='mso-fareast-font-family:"Times New Roman"'>
          Mapped:
          <o:p></o:p>
        </span>
      </h2>
      <p class=MsoNormal style='margin-left:35.4pt'>
        In this case the <span
          style='font-family:Consolas;mso-bidi-font-style:italic'>into</span> attributes
        lists which variable name is associated to which column name, with the equals
        sign. For example:
        <o:p></o:p>
      </p>
      <p class=MsoNormal>
        <o:p>&nbsp;</o:p>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;sql:query
          var=&quot;theQuery&quot; &gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          SELECT column_1,
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column_2,
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;something as column_3
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          FROM&nbsp;&nbsp; table
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;/sql:query&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &lt;MCh:forEachRow
          result=&quot;${theQuery}&quot; into=&quot;<b>var_first=column2</b>,var_second=column1,var_third=column3,var_fourth=column2&quot;&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          &lt;!-- var_first now contains the value of column2, etc. --&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span style='font-family:Consolas'>
          &nbsp;
          &lt;gel:log&gt;column2: ${var_first}, column1: ${var_second}, column3:
          ${var_third}, column2: ${var_fourth}&lt;/gel:log&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal style='margin-left:70.8pt'>
        <span lang=IT style='font-family:
          Consolas;mso-ansi-language:IT'>
          &lt;/MCh:forEachRow&gt;
          <o:p></o:p>
        </span>
      </p>
      <p class=MsoNormal>
        <o:p>&nbsp;</o:p>
      </p>
      <p class=MsoNormal style='margin-left:36.0pt'>Repeating a column name is allowed
        [as with column column_2 in the example above]; all variables pointing to the
        same column name will be assigned the same value.
      </p>
      <p class=MsoNormal style='margin-left:36.0pt'>Repeating a variable name is
        highly discouraged; currently, the first occurrence of a variable name will “win”,
        so this use case will not trigger an error. However this might change in a
        future release.
      </p>
      <p class=MsoNormal>
        <o:p>&nbsp;</o:p>
      </p>
    </div>
  </body>
</html>